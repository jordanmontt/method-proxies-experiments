# this run definition will be chosen if no parameters are given to rebench
default_experiment: all
default_data_file: 'cormas.csv'

# a set of suites with different benchmarks and possibly different settings
benchmark_suites:
    Alone:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench. bencher benchNoInstrumentation"
    AllocationGraph:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useAllocationCallGraphProfiler. bencher benchExecution"
    AllocationRate:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useAllocationRateProfiler. bencher benchExecution"
    MethodCallGraph:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useMethodCallGraphProfiler. bencher benchExecution"
    NoActionAllMethods:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllMethodsProfiler. bencher benchExecution"
    NoActionAllocatorMethods:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllocatorMethodsProfiler. bencher benchExecution"
#########
#########
    AllocationGraphRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useAllocationCallGraphProfiler. bencher benchExecution"
    AllocationRateRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useAllocationRateProfiler. bencher benchExecution"
    MethodCallGraphRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useMethodCallGraphProfiler. bencher benchExecution"
    NoActionAllMethodsRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useNoActionAllMethodsProfiler. bencher benchExecution"
    NoActionAllocatorMethodsRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 30
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useNoActionAllocatorMethodsProfiler. bencher benchExecution"
##
##
# a set of executables for the benchmark execution
executors:
    ExecutorCormas:
        path: "."
        executable: "reBenchRunner.sh"
        args: "./baseimage/pharo-vm/Pharo.app/Contents/MacOS/Pharo --headless ./cormas/cormas.image --no-default-preferences"


# combining benchmark suites and executions
experiments:
    Cormas:
        suites:
          - Alone
          #
          - AllocationGraph
          - AllocationRate
          - MethodCallGraph
          - NoActionAllocatorMethods
          - NoActionAllMethods
          #
          - AllocationGraphRWI
          - AllocationRateRWI
          - MethodCallGraphRWI
          - NoActionAllMethodsRWI
          - NoActionAllocatorMethodsRWI
        executions:
          - ExecutorCormas