# this run definition will be chosen if no parameters are given to rebench
default_experiment: all
default_data_file: 'cormas.csv'

# a set of suites with different benchmarks and possibly different settings
benchmark_suites:
    Alone:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench. bencher benchNoInstrumentation"
    AllocationRate:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useAllocationRateProfiler. bencher benchExecution"
    MethodCounter:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useMethodCounterProfiler. bencher benchExecution"
    NoActionAllMethods:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllMethodsProfiler. bencher benchExecution"
    NoActionAllocatorMethods:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllocatorMethodsProfiler. bencher benchExecution"
#########
#########
    AllocationRateRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useAllocationRateProfiler. bencher benchExecution"
    MethodCounterRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useMethodCounterProfiler. bencher benchExecution"
    NoActionAllMethodsRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useNoActionAllMethodsProfiler. bencher benchExecution"
    NoActionAllocatorMethodsRWI:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherRwi new. bencher useCormasBench; useNoActionAllocatorMethodsProfiler. bencher benchExecution"
#########
#########
    AllocationRateNoSafe:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useAllocationRateNoSafeProfiler. bencher benchExecution"
    MethodCounterNoSafe:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useMethodCounterNoSafeProfiler. bencher benchExecution"
    NoActionAllMethodsNoSafe:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllMethodsNoSafeProfiler. bencher benchExecution"
    NoActionAllocatorMethodsNoSafe:
        gauge_adapter: PlainSecondsLog
        command: |-
            eval "%(benchmark)s"
        input_sizes: [1]
        invocations: 1
        benchmarks:
            - "|bencher| bencher := BencherMp new. bencher useCormasBench; useNoActionAllocatorMethodsNoSafeProfiler. bencher benchExecution"
##
##
# a set of executables for the benchmark execution
executors:
    ExecutorCormas:
        path: "."
        executable: "reBenchRunner.sh"
        args: "./baseimage/pharo-vm/pharo --headless ./cormas/cormas.image --no-default-preferences"


# combining benchmark suites and executions
experiments:
    Cormas:
        suites:
          - Alone
          #
          - AllocationRate
          - MethodCounter
          - NoActionAllocatorMethods
          - NoActionAllMethods
          #
          - AllocationRateRWI
          - MethodCounterRWI
          - NoActionAllMethodsRWI
          - NoActionAllocatorMethodsRWI
          #
          - AllocationRateNoSafe
          - MethodCounterNoSafe
          - NoActionAllMethodsNoSafe
          - NoActionAllocatorMethodsNoSafe
        executions:
          - ExecutorCormas